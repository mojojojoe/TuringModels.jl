<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel="shortcut icon" type="image/png" href="/TuringModels.jl/assets/favicon.png"/> <link rel=stylesheet  href="/TuringModels.jl/libs/highlight/github.min.css"> <link rel=stylesheet  href="/TuringModels.jl/css/franklin.css"> <title>Estimate handedness for each Chimpanzee</title> <div class=franklin-content > <div class=top-bar > <a href="/TuringModels.jl/">TuringModels</a> </div> <h1>Estimate handedness for each Chimpanzee</h1> </div> <div class=franklin-content > <p>This is model <code>m10.4</code> in Statistical Rethinking Edition 1.</p> <div class=franklin-toc ><ol><li><a href="#data">Data</a><li><a href="#model">Model</a><li><a href="#output">Output</a><li><a href="#original_output">Original output</a></ol></div> <h2 id=data ><a href="#data" class=header-anchor >Data</a></h2> <pre><code class=language-julia >import CSV
import Random
import TuringModels

using DataFrames
using StatsFuns

Random.seed&#33;&#40;1&#41;

data_path &#61; joinpath&#40;TuringModels.project_root, &quot;data&quot;, &quot;chimpanzees.csv&quot;&#41;
df &#61; CSV.read&#40;data_path, DataFrame; delim&#61;&#39;;&#39;&#41;
first&#40;df, 10&#41;</code></pre><pre><code class=plaintext >10×8 DataFrame
 Row │ actor  recipient  condition  block  trial  prosoc_left  chose_prosoc  pulled_left
     │ Int64  String     Int64      Int64  Int64  Int64        Int64         Int64
─────┼───────────────────────────────────────────────────────────────────────────────────
   1 │     1  NA                 0      1      2            0             1            0
   2 │     1  NA                 0      1      4            0             0            1
   3 │     1  NA                 0      1      6            1             0            0
   4 │     1  NA                 0      1      8            0             1            0
   5 │     1  NA                 0      1     10            1             1            1
   6 │     1  NA                 0      1     12            1             1            1
   7 │     1  NA                 0      2     14            1             0            0
   8 │     1  NA                 0      2     16            1             0            0
   9 │     1  NA                 0      2     18            0             1            0
  10 │     1  NA                 0      2     20            0             1            0</code></pre> <h2 id=model ><a href="#model" class=header-anchor >Model</a></h2> <pre><code class=language-julia >using Turing

@model m10_4&#40;y, actors, x₁, x₂&#41; &#61; begin
    # Number of unique actors in the data set
    N_actor &#61; length&#40;unique&#40;actors&#41;&#41;

    # Set an TArray for the priors/param
    α ~ filldist&#40;Normal&#40;0, 10&#41;, N_actor&#41;
    βp ~ Normal&#40;0, 10&#41;
    βpC ~ Normal&#40;0, 10&#41;

    logits &#61; α&#91;actors&#93; .&#43; &#40;βp .&#43; βpC * x₁&#41; .* x₂
    y .~ BinomialLogit.&#40;1, logits&#41;
end

model &#61; m10_4&#40;df.pulled_left, df.actor, df.condition, df.prosoc_left&#41;;</code></pre> <h2 id=output ><a href="#output" class=header-anchor >Output</a></h2> <pre><code class=language-julia >chns &#61; sample&#40;model, NUTS&#40;&#41;, 1000&#41;</code></pre><pre><code class=plaintext >Chains MCMC chain (1000×21×1 Array{Float64, 3}):

Iterations        = 501:1:1500
Number of chains  = 1
Samples per chain = 1000
Wall duration     = 9.12 seconds
Compute duration  = 9.12 seconds
parameters        = βpC, α[5], α[1], α[7], α[2], α[6], α[3], βp, α[4]
internals         = lp, n_steps, is_accept, acceptance_rate, log_density, hamiltonian_energy, hamiltonian_energy_error, max_hamiltonian_energy_error, tree_depth, numerical_error, step_size, nom_step_size

Summary Statistics
  parameters      mean       std   naive_se      mcse         ess      rhat   ess_per_sec
      Symbol   Float64   Float64    Float64   Float64     Float64   Float64       Float64

        α[1]   -0.7498    0.2578     0.0082    0.0094    939.6271    0.9995      103.0745
        α[2]   10.7558    5.5484     0.1755    0.1993    348.3636    1.0009       38.2145
        α[3]   -1.0478    0.2882     0.0091    0.0107    863.7634    0.9992       94.7525
        α[4]   -1.0596    0.2783     0.0088    0.0128    701.8918    0.9991       76.9956
        α[5]   -0.7458    0.2816     0.0089    0.0099    866.2697    0.9990       95.0274
        α[6]    0.2262    0.2810     0.0089    0.0119   1059.6272    0.9998      116.2382
        α[7]    1.7900    0.4084     0.0129    0.0113    998.6316    1.0002      109.5471
          βp    0.8536    0.2690     0.0085    0.0123    463.3350    1.0011       50.8266
         βpC   -0.1559    0.3072     0.0097    0.0107    743.4991    0.9995       81.5598

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        α[1]   -1.2464   -0.9215   -0.7576   -0.5729   -0.2393
        α[2]    3.6650    6.5200    9.2989   13.7972   24.1867
        α[3]   -1.6345   -1.2293   -1.0499   -0.8612   -0.5014
        α[4]   -1.6078   -1.2424   -1.0646   -0.8763   -0.4969
        α[5]   -1.2867   -0.9452   -0.7551   -0.5536   -0.1999
        α[6]   -0.3196    0.0360    0.2302    0.4202    0.7655
        α[7]    1.0326    1.5107    1.7936    2.0513    2.6275
          βp    0.3225    0.6794    0.8513    1.0334    1.3902
         βpC   -0.7461   -0.3623   -0.1669    0.0490    0.4916
</code></pre> </p> <pre><code class=language-julia >using StatsPlots

StatsPlots.plot&#40;chns&#41;</code></pre> <p> <img src="/TuringModels.jl/assets/models/estimate-handedness-chimpanzees/code/output/chns.svg" alt=""> <h2 id=original_output ><a href="#original_output" class=header-anchor >Original output</a></h2> <pre><code class=language-julia >m_10_04s_result &#61; &quot;
Iterations &#61; 1:1000
Thinning interval &#61; 1
Chains &#61; 1,2,3,4
Samples per chain &#61; 1000

Empirical Posterior Estimates:
        Mean        SD       Naive SE       MCSE      ESS
a.1 -0.74503184 0.26613979 0.0042080396 0.0060183398 1000
a.2 10.77955494 5.32538998 0.0842018089 0.1269148045 1000
a.3 -1.04982353 0.28535997 0.0045119373 0.0049074219 1000
a.4 -1.04898135 0.28129307 0.0044476339 0.0056325117 1000
a.5 -0.74390933 0.26949936 0.0042611590 0.0052178124 1000
a.6  0.21599365 0.26307574 0.0041595927 0.0045153523 1000
a.7  1.81090866 0.39318577 0.0062168129 0.0071483527 1000
bp  0.83979926 0.26284676 0.0041559722 0.0059795826 1000
bpC -0.12913322 0.29935741 0.0047332562 0.0049519863 1000
&quot;;</code></pre> <div class=page-foot > <div class=copyright > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Rob Goedman, Richard Torkar, Rik Huijzer, Martin Trapp and contributors. Last modified: July 20, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> <script src="/TuringModels.jl/libs/highlight/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script>