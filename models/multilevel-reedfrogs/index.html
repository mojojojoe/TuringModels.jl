<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel="shortcut icon" type="image/png" href="/TuringModels.jl/assets/favicon.png"/> <link rel=stylesheet  href="/TuringModels.jl/libs/highlight/github.min.css"> <link rel=stylesheet  href="/TuringModels.jl/css/franklin.css"> <title>Multilevel Reedfrogs</title> <div class=franklin-content > <div class=top-bar > <a href="/TuringModels.jl/">TuringModels</a> </div> <h1>Multilevel Reedfrogs</h1> </div> <div class=franklin-content > <div class=franklin-toc ><ol><li><a href="#data">Data</a><li><a href="#model">Model</a><li><a href="#output">Output</a><li><a href="#original_output">Original output</a></ol></div> <h2 id=data ><a href="#data" class=header-anchor >Data</a></h2> <pre><code class=language-julia >import CSV
import Random

using DataFrames
using TuringModels: project_root

Random.seed&#33;&#40;1&#41;

path &#61; joinpath&#40;project_root, &quot;data&quot;, &quot;reedfrogs.csv&quot;&#41;
df &#61; CSV.read&#40;path, DataFrame; delim&#61;&#39;;&#39;&#41;
df.tank &#61; 1:nrow&#40;df&#41;
df</code></pre><pre><code class=plaintext >48×6 DataFrame
 Row │ density  pred    size    surv   propsurv  tank
     │ Int64    String  String  Int64  Float64   Int64
─────┼─────────────────────────────────────────────────
   1 │      10  no      big         9  0.9           1
   2 │      10  no      big        10  1.0           2
   3 │      10  no      big         7  0.7           3
   4 │      10  no      big        10  1.0           4
   5 │      10  no      small       9  0.9           5
   6 │      10  no      small       9  0.9           6
   7 │      10  no      small      10  1.0           7
   8 │      10  no      small       9  0.9           8
   9 │      10  pred    big         4  0.4           9
  10 │      10  pred    big         9  0.9          10
  11 │      10  pred    big         7  0.7          11
  12 │      10  pred    big         6  0.6          12
  13 │      10  pred    small       7  0.7          13
  14 │      10  pred    small       5  0.5          14
  15 │      10  pred    small       9  0.9          15
  16 │      10  pred    small       9  0.9          16
  17 │      25  no      big        24  0.96         17
  18 │      25  no      big        23  0.92         18
  19 │      25  no      big        22  0.88         19
  20 │      25  no      big        25  1.0          20
  21 │      25  no      small      23  0.92         21
  22 │      25  no      small      23  0.92         22
  23 │      25  no      small      23  0.92         23
  24 │      25  no      small      21  0.84         24
  25 │      25  pred    big         6  0.24         25
  26 │      25  pred    big        13  0.52         26
  27 │      25  pred    big         4  0.16         27
  28 │      25  pred    big         9  0.36         28
  29 │      25  pred    small      13  0.52         29
  30 │      25  pred    small      20  0.8          30
  31 │      25  pred    small       8  0.32         31
  32 │      25  pred    small      10  0.4          32
  33 │      35  no      big        34  0.971429     33
  34 │      35  no      big        33  0.942857     34
  35 │      35  no      big        33  0.942857     35
  36 │      35  no      big        31  0.885714     36
  37 │      35  no      small      31  0.885714     37
  38 │      35  no      small      35  1.0          38
  39 │      35  no      small      33  0.942857     39
  40 │      35  no      small      32  0.914286     40
  41 │      35  pred    big         4  0.114286     41
  42 │      35  pred    big        12  0.342857     42
  43 │      35  pred    big        13  0.371429     43
  44 │      35  pred    big        14  0.4          44
  45 │      35  pred    small      22  0.628571     45
  46 │      35  pred    small      12  0.342857     46
  47 │      35  pred    small      31  0.885714     47
  48 │      35  pred    small      17  0.485714     48</code></pre> <h2 id=model ><a href="#model" class=header-anchor >Model</a></h2> <pre><code class=language-julia >using Turing

# Thanks to Kai Xu&#33;

@model function m12_2&#40;density, tank, surv&#41;
    σ ~ truncated&#40;Cauchy&#40;0, 1&#41;, 0, Inf&#41;
    α ~ Normal&#40;0, 1&#41;

    N_tank &#61; length&#40;tank&#41;
    α_tank ~ filldist&#40;Normal&#40;α, σ&#41;, N_tank&#41;

    logitp &#61; α_tank&#91;tank&#93;
    surv .~ BinomialLogit.&#40;density, logitp&#41;
end;</code></pre> <h2 id=output ><a href="#output" class=header-anchor >Output</a></h2> <pre><code class=language-julia >chns &#61; sample&#40;
    m12_2&#40;df.density, df.tank, df.surv&#41;,
    NUTS&#40;&#41;,
    1000
&#41;</code></pre><pre><code class=plaintext >Chains MCMC chain (1000×62×1 Array{Float64, 3}):

Iterations        = 501:1:1500
Number of chains  = 1
Samples per chain = 1000
Wall duration     = 7.86 seconds
Compute duration  = 7.86 seconds
parameters        = α, α_tank[25], α_tank[18], α_tank[46], α_tank[19], α_tank[7], α_tank[16], α_tank[10], α_tank[31], α_tank[33], α_tank[45], α_tank[1], α_tank[23], α_tank[5], α_tank[24], α_tank[44], α_tank[38], α_tank[40], α_tank[22], σ, α_tank[17], α_tank[21], α_tank[13], α_tank[42], α_tank[34], α_tank[28], α_tank[35], α_tank[47], α_tank[9], α_tank[39], α_tank[26], α_tank[32], α_tank[29], α_tank[4], α_tank[20], α_tank[36], α_tank[14], α_tank[41], α_tank[2], α_tank[6], α_tank[37], α_tank[3], α_tank[30], α_tank[27], α_tank[11], α_tank[43], α_tank[8], α_tank[12], α_tank[15], α_tank[48]
internals         = lp, n_steps, is_accept, acceptance_rate, log_density, hamiltonian_energy, hamiltonian_energy_error, max_hamiltonian_energy_error, tree_depth, numerical_error, step_size, nom_step_size

Summary Statistics
  parameters      mean       std   naive_se      mcse         ess      rhat   ess_per_sec
      Symbol   Float64   Float64    Float64   Float64     Float64   Float64       Float64

           σ    1.6286    0.2193     0.0069    0.0066    795.7250    1.0000      101.2115
           α    1.3057    0.2541     0.0080    0.0084   1328.5004    1.0021      168.9774
   α_tank[1]    2.1176    0.8626     0.0273    0.0212   1683.2688    0.9991      214.1019
   α_tank[2]    3.0896    1.1282     0.0357    0.0288   1107.3058    1.0001      140.8428
   α_tank[3]    0.9778    0.7203     0.0228    0.0059   1585.1642    0.9990      201.6235
   α_tank[4]    3.0485    1.0961     0.0347    0.0326   1212.7436    1.0005      154.2538
   α_tank[5]    2.1513    0.9251     0.0293    0.0251   1213.2682    0.9990      154.3205
   α_tank[6]    2.1499    0.8927     0.0282    0.0215   1959.8886    0.9993      249.2863
   α_tank[7]    3.0452    1.0696     0.0338    0.0367   1334.9371    0.9995      169.7961
   α_tank[8]    2.1508    0.8942     0.0283    0.0274   1151.3186    1.0005      146.4409
   α_tank[9]   -0.1548    0.6110     0.0193    0.0074   2250.8985    0.9994      286.3010
  α_tank[10]    2.1297    0.8390     0.0265    0.0237   1448.8884    1.0000      184.2900
  α_tank[11]    0.9770    0.6587     0.0208    0.0161   1746.8160    0.9990      222.1847
  α_tank[12]    0.5764    0.6511     0.0206    0.0142   1912.8781    0.9990      243.3068
  α_tank[13]    1.0014    0.7116     0.0225    0.0206   1704.8663    0.9992      216.8489
  α_tank[14]    0.1872    0.6012     0.0190    0.0134   1625.1506    1.0011      206.7096
  α_tank[15]    2.1361    0.9210     0.0291    0.0238   1967.3689    1.0006      250.2377
  α_tank[16]    2.1358    0.8797     0.0278    0.0189   1398.3038    0.9990      177.8560
  α_tank[17]    2.9192    0.8530     0.0270    0.0237   1533.1385    0.9995      195.0062
  α_tank[18]    2.3827    0.6567     0.0208    0.0204   1399.6047    0.9991      178.0215
  α_tank[19]    2.0114    0.5879     0.0186    0.0120   1348.9007    0.9998      171.5722
  α_tank[20]    3.7103    1.0409     0.0329    0.0300   1490.5644    0.9993      189.5910
  α_tank[21]    2.3944    0.6517     0.0206    0.0226   1438.4752    1.0005      182.9656
  α_tank[22]    2.4265    0.6712     0.0212    0.0145   1771.8315    0.9993      225.3665
  α_tank[23]    2.3724    0.6425     0.0203    0.0116   1314.4065    0.9998      167.1848
  α_tank[24]    1.6865    0.5145     0.0163    0.0112   1943.9746    1.0000      247.2621
  α_tank[25]   -0.9952    0.4509     0.0143    0.0137   1194.3414    1.0007      151.9132
  α_tank[26]    0.1508    0.4134     0.0131    0.0084   1917.2153    1.0003      243.8585
  α_tank[27]   -1.4376    0.5010     0.0158    0.0104   1952.4944    0.9990      248.3458
  α_tank[28]   -0.4821    0.4014     0.0127    0.0062   2151.6091    0.9991      273.6720
  α_tank[29]    0.1526    0.4137     0.0131    0.0066   2244.5244    0.9996      285.4903
  α_tank[30]    1.4278    0.4417     0.0140    0.0088   2201.2658    1.0008      279.9880
  α_tank[31]   -0.6469    0.4070     0.0129    0.0102   1785.1007    0.9996      227.0543
  α_tank[32]   -0.3195    0.4156     0.0131    0.0076   1909.0959    0.9992      242.8257
  α_tank[33]    3.1752    0.7265     0.0230    0.0223   1405.5056    0.9998      178.7720
  α_tank[34]    2.7312    0.6442     0.0204    0.0210   1149.8877    1.0016      146.2589
  α_tank[35]    2.7145    0.6403     0.0202    0.0084   1474.6904    0.9995      187.5719
  α_tank[36]    2.0584    0.5204     0.0165    0.0152   1616.8354    0.9990      205.6519
  α_tank[37]    2.0425    0.5106     0.0161    0.0121   1661.0486    1.0011      211.2756
  α_tank[38]    3.9039    0.9490     0.0300    0.0283   1553.4017    0.9990      197.5835
  α_tank[39]    2.7185    0.6582     0.0208    0.0115   1091.6723    0.9991      138.8543
  α_tank[40]    2.3148    0.5695     0.0180    0.0171   1205.3503    1.0013      153.3134
  α_tank[41]   -1.8051    0.4494     0.0142    0.0098   1563.3980    0.9995      198.8550
  α_tank[42]   -0.5799    0.3481     0.0110    0.0079   1911.6294    0.9999      243.1480
  α_tank[43]   -0.4638    0.3574     0.0113    0.0079   2051.9151    0.9990      260.9915
  α_tank[44]   -0.3490    0.3457     0.0109    0.0085   2514.4044    1.0008      319.8174
  α_tank[45]    0.5792    0.3381     0.0107    0.0085   1820.6594    0.9997      231.5771
  α_tank[46]   -0.5746    0.3761     0.0119    0.0115   1505.6258    1.0001      191.5067
  α_tank[47]    2.0557    0.5250     0.0166    0.0101   1985.8436    0.9991      252.5876
  α_tank[48]   -0.0001    0.3602     0.0114    0.0080   2529.3754    0.9990      321.7216

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           σ    1.2525    1.4785    1.6153    1.7679    2.1148
           α    0.8136    1.1394    1.3026    1.4632    1.8188
   α_tank[1]    0.5262    1.5297    2.0484    2.6259    4.0167
   α_tank[2]    1.1475    2.3014    3.0046    3.7098    5.7448
   α_tank[3]   -0.3183    0.4912    0.9202    1.4529    2.4690
   α_tank[4]    1.1440    2.2802    2.9426    3.7166    5.6051
   α_tank[5]    0.5173    1.4837    2.0915    2.7283    4.2276
   α_tank[6]    0.5801    1.5371    2.0848    2.6795    4.1704
   α_tank[7]    1.1765    2.3189    2.9521    3.6532    5.4448
   α_tank[8]    0.6123    1.5471    2.0524    2.6646    4.0759
   α_tank[9]   -1.3817   -0.5865   -0.1299    0.2509    0.9854
  α_tank[10]    0.6091    1.5742    2.0630    2.6224    3.9400
  α_tank[11]   -0.2176    0.5098    0.9612    1.3862    2.2899
  α_tank[12]   -0.6658    0.1373    0.5648    0.9861    1.9104
  α_tank[13]   -0.2401    0.5142    0.9828    1.4230    2.5037
  α_tank[14]   -0.9970   -0.2150    0.2012    0.5761    1.3381
  α_tank[15]    0.5032    1.4942    2.0894    2.6932    4.1646
  α_tank[16]    0.6400    1.5187    2.0732    2.7243    3.9697
  α_tank[17]    1.4363    2.2881    2.8520    3.4634    4.7816
  α_tank[18]    1.1871    1.9479    2.3284    2.8060    3.8656
  α_tank[19]    0.9542    1.6036    1.9589    2.3895    3.2824
  α_tank[20]    2.0580    2.9259    3.6184    4.4023    6.0142
  α_tank[21]    1.2346    1.9757    2.3298    2.7896    3.8769
  α_tank[22]    1.2568    1.9273    2.3776    2.8647    3.8428
  α_tank[23]    1.2646    1.9237    2.3319    2.7289    3.7912
  α_tank[24]    0.7687    1.3218    1.6601    2.0154    2.7909
  α_tank[25]   -1.8879   -1.2655   -0.9846   -0.6953   -0.1725
  α_tank[26]   -0.6447   -0.1180    0.1301    0.4079    1.0197
  α_tank[27]   -2.4972   -1.7456   -1.4178   -1.0765   -0.5723
  α_tank[28]   -1.2754   -0.7449   -0.4714   -0.2039    0.2926
  α_tank[29]   -0.6970   -0.1330    0.1488    0.4450    0.9800
  α_tank[30]    0.6302    1.1171    1.3933    1.7232    2.3341
  α_tank[31]   -1.4625   -0.9137   -0.6421   -0.3780    0.1422
  α_tank[32]   -1.1198   -0.6168   -0.3204   -0.0279    0.4807
  α_tank[33]    1.8999    2.6513    3.1134    3.6355    4.7131
  α_tank[34]    1.6560    2.2456    2.7023    3.1138    4.1553
  α_tank[35]    1.6036    2.2723    2.6636    3.0950    4.1721
  α_tank[36]    1.1584    1.6904    2.0240    2.3882    3.2683
  α_tank[37]    1.1228    1.6859    2.0030    2.3650    3.0999
  α_tank[38]    2.3035    3.2660    3.8138    4.4572    6.0319
  α_tank[39]    1.5882    2.2636    2.6696    3.1083    4.1105
  α_tank[40]    1.3341    1.9120    2.2726    2.6680    3.5313
  α_tank[41]   -2.7501   -2.0825   -1.7846   -1.4825   -1.0271
  α_tank[42]   -1.2603   -0.8239   -0.5746   -0.3260    0.0455
  α_tank[43]   -1.1941   -0.6954   -0.4642   -0.2158    0.2030
  α_tank[44]   -1.0398   -0.5675   -0.3492   -0.1180    0.2956
  α_tank[45]   -0.0802    0.3544    0.5652    0.7960    1.2854
  α_tank[46]   -1.3491   -0.8218   -0.5672   -0.3135    0.1454
  α_tank[47]    1.1524    1.6801    2.0329    2.4012    3.1858
  α_tank[48]   -0.7390   -0.2362    0.0038    0.2317    0.7140
</code></pre> </p> <pre><code class=language-julia >using StatsPlots

StatsPlots.plot&#40;chns&#41;</code></pre> <p> <img src="/TuringModels.jl/assets/models/multilevel-reedfrogs/code/output/chns.svg" alt=""> <h2 id=original_output ><a href="#original_output" class=header-anchor >Original output</a></h2> <pre><code class=language-julia >m122rethinking &#61; &quot;
                mean   sd  5.5&#37; 94.5&#37; n_eff Rhat
a               1.30 0.25  0.90  1.70 11662    1
sigma       1.62 0.22  1.30  1.99  6556    1
a_tank&#91;1&#93;   2.12 0.88  0.84  3.60 16091    1
a_tank&#91;2&#93;   3.05 1.10  1.52  4.92 10962    1
a_tank&#91;3&#93;   1.00 0.66 -0.02  2.10 18175    1
a_tank&#91;4&#93;   3.05 1.11  1.47  4.96 10181    1
a_tank&#91;5&#93;   2.13 0.87  0.85  3.62 13720    1
a_tank&#91;6&#93;   2.12 0.86  0.86  3.59 11628    1
a_tank&#91;7&#93;   3.07 1.13  1.47  5.03 10315    1
a_tank&#91;8&#93;   2.13 0.87  0.86  3.60 13754    1
a_tank&#91;9&#93;  -0.18 0.60 -1.14  0.76 18218    1
a_tank&#91;10&#93;  2.11 0.86  0.83  3.58 15121    1
a_tank&#91;11&#93;  1.00 0.67 -0.04  2.09 17390    1
a_tank&#91;12&#93;  0.58 0.62 -0.41  1.60 17209    1
a_tank&#91;13&#93;  0.99 0.66 -0.04  2.09 15225    1
a_tank&#91;14&#93;  0.19 0.62 -0.79  1.20 18293    1
a_tank&#91;15&#93;  2.13 0.89  0.83  3.63 12445    1
a_tank&#91;16&#93;  2.11 0.87  0.87  3.61 12385    1
a_tank&#91;17&#93;  2.89 0.80  1.76  4.29 12583    1
a_tank&#91;18&#93;  2.38 0.66  1.43  3.49 14437    1
a_tank&#91;19&#93;  2.00 0.58  1.12  2.99 13959    1
a_tank&#91;20&#93;  3.67 1.03  2.20  5.44 10629    1
a_tank&#91;21&#93;  2.38 0.65  1.42  3.47 15309    1
a_tank&#91;22&#93;  2.39 0.66  1.42  3.49 13614    1
a_tank&#91;23&#93;  2.40 0.67  1.41  3.53 11868    1
a_tank&#91;24&#93;  1.69 0.52  0.90  2.55 18468    1
a_tank&#91;25&#93; -1.00 0.45 -1.74 -0.30 18153    1
a_tank&#91;26&#93;  0.16 0.40 -0.47  0.81 21895    1
a_tank&#91;27&#93; -1.44 0.50 -2.28 -0.69 16718    1
a_tank&#91;28&#93; -0.47 0.41 -1.15  0.17 20160    1
a_tank&#91;29&#93;  0.15 0.40 -0.48  0.80 19401    1
a_tank&#91;30&#93;  1.44 0.49  0.70  2.24 15407    1
a_tank&#91;31&#93; -0.64 0.42 -1.33 -0.01 15356    1
a_tank&#91;32&#93; -0.31 0.40 -0.95  0.32 19130    1
a_tank&#91;33&#93;  3.18 0.78  2.06  4.55 10894    1
a_tank&#91;34&#93;  2.70 0.66  1.75  3.84 13573    1
a_tank&#91;35&#93;  2.69 0.64  1.74  3.78 13876    1
a_tank&#91;36&#93;  2.06 0.53  1.26  2.92 16329    1
a_tank&#91;37&#93;  2.06 0.51  1.29  2.91 14672    1
a_tank&#91;38&#93;  3.88 0.97  2.52  5.57  9349    1
a_tank&#91;39&#93;  2.70 0.64  1.77  3.78 13444    1
a_tank&#91;40&#93;  2.34 0.56  1.49  3.31 14966    1
a_tank&#91;41&#93; -1.82 0.48 -2.61 -1.10 14214    1
a_tank&#91;42&#93; -0.58 0.36 -1.16 -0.02 17203    1
a_tank&#91;43&#93; -0.46 0.35 -1.02  0.08 17762    1
a_tank&#91;44&#93; -0.34 0.34 -0.90  0.20 16740    1
a_tank&#91;45&#93;  0.58 0.35  0.02  1.14 18946    1
a_tank&#91;46&#93; -0.57 0.34 -1.13 -0.03 19761    1
a_tank&#91;47&#93;  2.05 0.51  1.30  2.90 15122    1
a_tank&#91;48&#93;  0.00 0.33 -0.53  0.53 18236    1
&quot;;</code></pre> <div class=page-foot > <div class=copyright > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Rob Goedman, Richard Torkar, Rik Huijzer, Martin Trapp and contributors. Last modified: July 20, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> <script src="/TuringModels.jl/libs/highlight/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script>